# Boiler Configuration
# This file configures the central boiler control and safety interlocks

boiler:
  # Boiler control entity
  # Currently: Nest Thermostat 3rd Gen via OpenTherm (binary on/off only)
  # Future: Ihor Melnyk OT shield on ESP32 (full OpenTherm modulation)
  entity_id: climate.boiler
  
  # OpenTherm mode
  # false: Binary on/off control via setpoint (Nest mode)
  # true: Full OpenTherm modulation (future implementation)
  opentherm: false
  
  # Binary on/off control settings (used when opentherm: false)
  binary_control:
    # Setpoint to command when we want heat
    on_setpoint_c: 30.0
    # Setpoint to command when we want boiler off
    off_setpoint_c: 5.0
  
  # Pump overrun handling
  # Boiler pump continues to run after heating stops to dissipate residual heat
  # TRVs must remain open during this period to allow water to flow
  pump_overrun_s: 180  # ~3 minutes (adjust after measuring actual boiler behavior)
  
  # Anti-short-cycling protection
  # Prevents rapid on/off cycles that damage the boiler and waste energy
  anti_cycling:
    # Minimum time boiler must stay ON once started (seconds)
    # min_on_time_s: 180
    min_on_time_s: 60 # temporary debugging change
    # Minimum time boiler must stay OFF once stopped (seconds)
    # min_off_time_s: 180
    min_off_time_s: 60 # temporary debugging change
    # Delay before turning off when demand stops (seconds)
    # Prevents cycling when users adjust setpoints or rooms briefly stop calling
    off_delay_s: 30
  
  # TRV-open interlock safety configuration
  # Ensures the boiler never runs without sufficient flow path available
  interlock:
    # Minimum total valve opening percentage required before boiler can turn on
    # Sum of all TRV open percentages must be >= this value
    # Default: 100 (ensures water always has somewhere to go)
    min_valve_open_percent: 100
  
  # Emergency safety room (fail-safe for hot water flow)
  # If boiler is ON but no rooms calling for heat, this room's valve will be
  # forced open to 100% to ensure there's a path for hot water.
  # This is a CRITICAL safety feature - never run boiler with all valves closed!
  safety_room: games  # Dining room - chosen as it's centrally located
